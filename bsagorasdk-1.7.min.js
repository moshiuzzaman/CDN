document.getElementById("bs__chat__root").innerHTML+='<div class="cems__chatbox">\n<div class="cems__chatbox__support">\n  <div id="cems__chatbox__chatlists">\n    <div id="cems__chatlist__header">\n      <h3 id="cems__chatlist__header__text">Chats</h3>\n    </div>\n    <div id="cems__all__chatlist">\n      <div class="cems__chat__list">\n        <div class="cems__friend__icon">\n          <p>F</p>\n        </div>\n        <div class="cems__chatlist__content">\n          <h4 class="cems__chatlist__friendName">Friend\'s Name</h4>\n        </div>\n      </div>\n    </div>\n    <div class="cems__chatbox__chatlist__footer">\n      <div class="cems__chatlist__footer__button" onclick="backToChatList()">\n        <img class="chatlist__footer__chatIcon" src="https://img.icons8.com/ios/100/000000/communication.png" />\n        <div id="unreadMessageCount">\n          <p id="unreadMessageCountP">1</p>\n        </div>\n        <p>Chats</p>\n      </div>\n      <div class="cems__chatlist__footer__button" onclick="gotoUsers()">\n        <img class="chatlist__footer__userIcon" src="https://img.icons8.com/ios/50/000000/user.png" />\n        <p>Users</p>\n      </div>\n    </div>\n  </div>\n  <div id="cems__chatbox__chatting" class="cems__hide__section">\n    <div class="cems__chatbox__header">\n      <div id="cems__chatbox_backButton--header" onclick="backToChatList()">\n        <img src="https://img.icons8.com/ios-filled/100/000000/left.png" />\n      </div>\n\n      <div class="cems__friend__icon">\n        <p>F</p>\n      </div>\n      <div class="cems__chatbox__content--header">\n        <h4 class="cems__chatbox__heading--header">Friend\'s Name</h4>\n      </div>\n    </div>\n    <div id="cems__chatbox__messages">\n      <div>\n        <div class="cems__messages__item cems__messages__item--visitor">Can you let me talk to the support?</div>\n        <div class="cems__messages__item cems__messages__item--operator">Sure!</div>\n      </div>\n    </div>\n    <div class="cems__chatbox__footer">\n      <img\n        src="https://img.icons8.com/external-kmg-design-outline-color-kmg-design/64/000000/external-attachment-user-interface-kmg-design-outline-color-kmg-design.png"\n      />\n      <input type="text" placeholder="Write a message..." />\n      <button class="cems__chatbox__send--footer">Send</button>\n    </div>\n  </div>\n</div>\n<div class="cems__chatbox__button cems__hide__section" id="cems__chatbox__button">\n  <button>button</button>\n</div>\n</div>\n<div id="bs__root"></div>\n<div id="cems__log" hidden></div>\n\x3c!-- <button id="cems__myBtn">Open Modal</button> --\x3e\n<div id="cems__myModal" class="cems__modal">\n<div id="cems__callsection">\n  <div id="cems__call__content">\n    <h3 class="cems__calltype">Outgoing Call</h3>\n    <div class="cems__callImage">\n      <img class="cems__callImage" src="https://img.icons8.com/ios/50/000000/user-male-circle.png" />\n      <h4>Calling Shozon</h4>\n      <div class="cems__callButtons">\n        <button class="cems__reciveBtn">Recive</button>\n        <button class="cems__cancleBtn">Cancle</button>\n      </div>\n    </div>\n  </div>\n</div>\n</div>';var fontAdd=document.createElement("link");fontAdd.rel="stylesheet",fontAdd.href="https://fonts.googleapis.com/css2?family=Barlow:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Inter:wght@100;200;300;400;500;600;700;800;900&display=swap";var cssstyles='* {\n  box-sizing: border-box;\n  margin: 0;\n  padding: 0;\n}\n\n*,\nhtml {\n  --primaryGradient: linear-gradient(93.12deg, #ffffff 0.52%, #f0e9e9 100%);\n  --secondaryGradient: linear-gradient(268.91deg, #fefeff -2.14%, #ffffff 99.69%);\n  --primaryBoxShadow: 0px 10px 15px rgba(105, 102, 102, 0.1);\n  --secondaryBoxShadow: 0px -10px 15px rgba(0, 0, 0, 0.1);\n  --light: 300;\n  --regular: 400;\n  --semiBold: 600;\n  --extraLight: 300;\n  --italic: 300;\n  --primary: #0998f5;\n}\n\n/* 300;0,400;0,600;1,300 */\n\nbody {\n  font-family: "Barlow", sans-serif;\n  font-weight: 400;\n  font-size: 100%;\n}\n/* width */\n::-webkit-scrollbar {\n  width: 10px;\n}\n\n/* Track */\n::-webkit-scrollbar-track {\n  background: rgba(255, 255, 255, 0);\n}\n\n/* Handle */\n::-webkit-scrollbar-thumb {\n  background: rgb(204, 204, 204);\n}\n\n/* Handle on hover */\n::-webkit-scrollbar-thumb:hover {\n  background: rgb(177, 174, 174);\n}\n\n/* CHATBOX\n=============== */\n.cems__chatbox {\n  position: absolute;\n  bottom: 30px;\n  right: 30px;\n}\n\n/* CONTENT IS CLOSE */\n.cems__chatbox__support {\n  display: flex;\n  flex-direction: column;\n  background: #eee;\n  width: 300px;\n  height: 350px;\n  z-index: -123456;\n  opacity: 0;\n  transition: all 0.5s ease-in-out;\n}\n\n/* CONTENT ISOPEN */\n.cems__chatbox--active {\n  transform: translateY(-40px);\n  z-index: 123456;\n  opacity: 1;\n}\n\n/* BUTTON */\n.cems__chatbox__button {\n  text-align: right;\n  position: fixed;\n  right: 26px;\n  bottom: 16px;\n}\ndiv#cems__chatbox__button button {\n  background: #03a9f4;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: 70px;\n  height: 70px;\n  border-radius: 500px;\n  box-shadow: rgb(0 0 0 / 39%) 0px 0px 15px;\n}\nimg.arrowIcon {\n  padding-top: 6px;\n}\n.cems__chatbox__button img {\n  transition: transform 0.3s;\n  width: 40px;\n}\n/* .cems__chatbox__button:hover img {\n  transform: rotate(22deg);\n} */\n\n/* HEADER */\n.cems__chatbox__header {\n  position: sticky;\n  top: 0;\n  background: orange;\n}\n\n/* MESSAGES */\n#cems__chatbox__messages {\n  margin-top: auto;\n  display: flex;\n  flex-direction: column;\n  overflow-y: scroll;\n  /* flex-direction: column-reverse; */\n  min-height: 70%;\n  background: white;\n}\n\n.cems__messages__item {\n  background: orange;\n  max-width: 60.6%;\n  width: fit-content;\n}\n\n.cems__messages__item--operator {\n  margin-left: auto;\n}\n\n.cems__messages__item--visitor {\n  margin-right: auto;\n}\n\n/* FOOTER */\n.cems__chatbox__footer {\n  position: sticky;\n  bottom: 0;\n}\n\n.cems__chat__callicon img {\n  width: 25px;\n  cursor: pointer;\n  float: right;\n}\n.cems__chat__callicon {\n  width: 113px;\n}\ndiv#cems__chatbox_backButton--header {\n  width: 36px;\n}\nimg.cems__chat__audioCallicon {\n  transform: rotate(-87deg);\n}\n.cems__chat__callicon img:last-child {\n  margin-right: 20px;\n}\n.cems__chatbox__support p {\n  margin-bottom: 0;\n}\n.cems__chatbox__support {\n  background: #f9f9f9;\n  height: 438px;\n  width: 390px;\n  box-shadow: rgb(0 0 0 / 39%) 0px 0px 15px;\n  border-radius: 20px;\n  position: fixed;\n  right: 32px;\n  bottom: 70px;\n  overflow: hidden;\n}\n\n/* HEADER */\n.cems__chatbox__header {\n  background: #eff1f1;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  padding: 0px 10px;\n  border-top-left-radius: 20px;\n  border-top-right-radius: 20px;\n  justify-content: space-between;\n  border-bottom: 1px solid #e8e8e8;\n  min-height: 75px;\n}\n.cems__chat__details {\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  align-items: center;\n}\n.cems__chatbox__image--header {\n  margin-right: 10px;\n}\n\n.cems__chatbox__heading--header {\n  font-size: 18px;\n  line-height: 18px;\n  font-weight: 600;\n}\n\n.cems__chatbox__image--header img {\n  width: 33px;\n  margin-bottom: -6px;\n}\n.cems__chatbox__description--header {\n  font-size: 0.9rem;\n  color: white;\n}\n/* Messages */\n#cems__chatbox__messages {\n  padding: 0 20px;\n}\n\n.cems__messages__item {\n  margin-top: 10px;\n  background: #e0e0e0;\n  padding: 8px 12px;\n  max-width: 100%;\n  font-size: 13px;\n}\n.cems__messages__item--operator_image {\n  margin-left: auto;\n  padding: 0;\n  background: none;\n}\n.cems__messages__item--operator_image img {\n  border-top-left-radius: 20px;\n  border-top-right-radius: 20px;\n  border-bottom-left-radius: 20px;\n}\n\n.cems__messages__item--visitor,\n.cems__messages__item--typing {\n  border-top-left-radius: 20px;\n  border-top-right-radius: 20px;\n  border-bottom-right-radius: 20px;\n}\n.cems__messages__item--visitor_image {\n  padding: 0;\n  background: none;\n}\n.cems__messages__item--visitor_image img {\n  border-top-left-radius: 20px;\n  border-top-right-radius: 20px;\n  border-bottom-right-radius: 20px;\n}\n\n.cems__messages__item--operator {\n  border-top-left-radius: 20px;\n  border-top-right-radius: 20px;\n  border-bottom-left-radius: 20px;\n  background: var(--primary);\n  color: white;\n}\n.cems__messages__time-operator {\n  margin-left: auto;\n  font-size: 7px;\n  margin-top: 4px;\n  color: gray;\n}\n.cems__messages__time-visitor {\n  font-size: 7px;\n  margin-top: 4px;\n  color: gray;\n}\n/* FOOTER */\n.cems__chatbox__footer,\n.cems__chatbox__chatlist__footer,\n.cems__chatbox__footer_inmessage {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: space-between;\n  padding: 10px 10px;\n  background: #eff1f1;\n  border-bottom-right-radius: 10px;\n  border-bottom-left-radius: 10px;\n  z-index: 99999999999;\n}\n.cems__chatbox__footer_inmessage {\n  padding: 13px 10px;\n}\n.cems__chatbox__chatlist__footer {\n  justify-content: space-around;\n  margin-top: 0;\n}\n.cems__chatlist__footer__button {\n  align-items: center;\n  text-align: center;\n  cursor: pointer;\n  position: relative;\n}\n.cems__chatlist__footer__button p {\n  padding: 4px;\n  cursor: pointer;\n  display: flex;\n  flex-direction: column;\n  -webkit-box-pack: center;\n  justify-content: center;\n  -webkit-box-align: center;\n  align-items: center;\n  font-size: 12px;\n}\n.cems__chatlist__footer__button img {\n  width: 25px;\n  margin-bottom: -6px;\n}\n#unreadMessageCount {\n  display: none;\n  position: absolute;\n  bottom: 17px;\n  right: 4px;\n  font-size: 5px;\n  width: 13px;\n  height: 13px;\n  background: black;\n  border-radius: 50%;\n  color: white;\n  justify-content: center;\n  align-items: center;\n  font-weight: bold;\n}\n#unreadMessageCount p {\n  font-size: 10px;\n}\n.cems__chatbox__footer img,\n.cems__chatbox__footer_inmessage img {\n  width: 23px;\n  cursor: pointer;\n}\n.cems__chatbox__footer_inmessage input {\n  border: none;\n  padding: 11px 10px;\n  border-radius: 30px;\n  width: 94%;\n  margin: 0px 10px;\n  border: 1px solid #dfdbdb;\n  font-size: 12px;\n}\ninput#cems__input__message:focus-visible {\n  outline: none;\n}\ndiv#cems_send_message {\n  width: 100%;\n}\ndiv#selectFileShow {\n  padding: 10px 10px;\n  border-radius: 30px;\n  width: 90%;\n  margin: 0px 10px;\n  border: 1px solid #dfdbdb;\n  font-size: 12px;\n}\ndiv#sendMessageBtn img {\n  width: 31px;\n}\n.cems__chatbox__send--footer {\n  color: white;\n  border: none;\n  cursor: pointer;\n  position: absolute;\n  right: 19px;\n  border-radius: 0 27px 25px 0;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  background: none;\n  margin: 0px 15px 0 0;\n}\nbutton#sendMessageBtn img {\n  width: 25px;\n}\n.bs__loader {\n  border: 3px solid #f3f3f3;\n  border-radius: 50%;\n  border-top: 3px solid #3498db;\n  width: 26px;\n  height: 26px;\n  -webkit-animation: spin 2s linear infinite; /* Safari */\n  animation: spin 2s linear infinite;\n}\n\n/* Safari */\n@-webkit-keyframes spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n  }\n}\n\n@keyframes spin {\n  0% {\n    transform: rotate(0deg);\n  }\n  100% {\n    transform: rotate(360deg);\n  }\n}\n.cems__chatbox__button button,\n.cems__chatbox__button button:focus,\n.cems__chatbox__button button:visited {\n  border: none;\n  outline: none;\n  border-radius: 74px;\n  cursor: pointer;\n}\n\n/* Chat aditional css */\n.cems__container h4 {\n  font-size: 15px;\n  font-weight: 600;\n  line-height: 22px;\n  margin: 0;\n}\np.cems__onlineText {\n  font-size: 10px;\n  color: green;\n}\np.cems__offlineText {\n  font-size: 10px;\n  color: gray;\n}\n#cems__chatbox_backButton--header img {\n  width: 31px;\n  justify-content: center;\n  align-items: center;\n  margin-bottom: -7px;\n  margin-right: 11px;\n  cursor: pointer;\n}\ndiv#cems__chatbox__chatting {\n  display: flex;\n  flex-direction: column;\n  background: #f9f9f9;\n  height: 430px;\n  width: 390px;\n  border-radius: 38px;\n}\ndiv#bs__image_fileSelect {\n  position: absolute;\n  bottom: 73px;\n  background: #eff1f1;\n  width: 184px;\n  height: auto;\n  left: -416px;\n  padding: 0 11px;\n  border-radius: 11px;\n  transition: all 0.1s;\n}\ndiv#bs__image_fileSelect div {\n  margin: 12px 0;\n}\ndiv#bs__image_fileSelect p {\n  display: inline-block;\n  margin-left: 10px;\n  cursor: pointer;\n}\ndiv#bs__image_fileSelect img {\n  display: inline-block;\n  width: 23px;\n  cursor: pointer;\n}\ndiv#bs_input_file_output {\n  position: absolute;\n  background: #eff1f1;\n  min-width: 150px;\n  height: 130px;\n  bottom: 73px;\n  left: -416px;\n  display: flex;\n  align-items: center;\n  padding: 10px;\n  border-radius: 15px;\n  transition: all 0.1s;\n}\nimg#bs_input_file_show_image {\n  width: 100px;\n  border-radius: 10px;\n}\ndiv#bs_input_file_show p {\n  text-align: center;\n  font-size: 12px;\n}\n#selectFileRemoveIcon {\n  width: 23px;\n  height: 23px;\n  transform: rotate(45deg);\n  cursor: pointer;\n  margin-right: 10px;\n}\ndiv#bs_input_file_show {\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n}\n.cems__hide__section {\n  display: none !important;\n}\ndiv#cems__chatlist__header {\n  border-bottom: 1px solid rgb(234, 234, 234);\n}\n.cems__chatlist__content {\n  display: block;\n  width: 100%;\n  border-bottom: 1px solid rgb(234, 234, 234);\n  padding-bottom: 8px;\n}\n\n.cems__chatlist__time {\n  width: 21%;\n  float: right;\n  font-size: 6px !important;\n}\n.cems__chatlist_fNameAndMessage {\n  width: 79%;\n  float: left;\n}\n.cems__chatlist__content p {\n  margin: 0px;\n  font-size: 13px;\n  font-weight: 400;\n  width: calc(100% - 50px);\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  line-height: 20px;\n  color: rgba(20, 20, 20, 0.6);\n}\n.cems__chatlist__time p {\n  width: 100%;\n  font-size: 11px;\n}\ndiv#cems__chatlist__header h3 {\n  padding: 22px 22px;\n  margin: 0px;\n  display: inline-block;\n  width: 100%;\n  text-align: left;\n  font-size: 22px;\n  font-weight: 700;\n  line-height: 26px;\n}\ndiv#cems__all__chatlist {\n  height: 306px;\n  overflow-y: scroll;\n}\np.cems__no_found {\n  margin-top: 20px;\n  margin-left: 17px;\n}\n.cems__chat__list {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  padding: 12px 19px;\n  cursor: pointer;\n}\n.unseen__message h4 {\n  color: rgb(0, 0, 0) !important;\n  font-weight: 700 !important;\n}\n.cems__chat__list h4 {\n  font-weight: 500;\n  text-transform: capitalize;\n}\n.cems__chat__list .chatListLastMessage {\n  color: #000000;\n}\n.cems__chat__list:hover {\n  background: #cddef7;\n}\n.unseen__message .chatListLastMessage {\n  color: #60a5fa;\n  font-weight: 700;\n  font-size: 12px;\n  line-height: 14.06px;\n  line-height: 14.06px;\n  margin-top: 5px;\n}\n.unseen__message .chatListLastMessageTime {\n  color: #7a7a7a;\n  font-weight: 400;\n  font-size: 10px;\n  line-height: 11.72px;\n}\n\n.cems__friend__icon {\n  background: #a7baff;\n  text-align: center;\n  border-radius: 50%;\n  color: black;\n  width: 48px;\n  height: 39px;\n  justify-content: center;\n  align-items: center;\n  display: flex;\n  margin: -4px 15px 2px -6px;\n}\n.cems__chatbox__content--header {\n  margin-left: 10px;\n}\n.cems__chatHead__friend__icon {\n  background: #a7baff;\n  text-align: center;\n  border-radius: 50%;\n  min-width: 39px;\n  min-height: 39px;\n  justify-content: center;\n  align-items: center;\n  display: flex;\n  color: #fcf2f2;\n  font-weight: 700;\n  font-size: 20px;\n  position: relative;\n}\ndiv#cems__onlineOrOfflineIcon {\n  width: 10px;\n  height: 10px;\n  position: absolute;\n  border-radius: 50%;\n  bottom: 0;\n  right: 2px;\n}\n.cems__onlineIcon {\n  background: #009688;\n}\n.cems__offlineIcon {\n  background: #ababab;\n}\n.cems__friend__icon h3 {\n  font-weight: 700;\n  font-size: 20px;\n  color: #fcf2f2;\n  margin-bottom: 0;\n}\n\n.cems__modal {\n  display: none;\n  position: fixed;\n  z-index: 555555;\n  left: 0;\n  top: 0;\n  width: 100%;\n  height: 100%;\n  overflow: auto;\n  background-color: rgba(0, 0, 0, 0.705);\n  justify-content: center;\n  align-items: center;\n  text-align: center;\n}\n/* Modal Content */\n.cems__modal-content {\n  background-color: #fefefe;\n  margin: auto;\n  padding: 20px;\n  border: 1px solid #888;\n  width: 80%;\n}\n\n/* The Close Button */\n.cems__close {\n  color: #aaaaaa;\n  float: right;\n  font-size: 28px;\n  font-weight: bold;\n}\n\n.cems__close:hover,\n.cems__close:focus {\n  color: #000;\n  text-decoration: none;\n  cursor: pointer;\n}\ndiv#cems__callsection {\n  width: 96%;\n  height: 98%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border-radius: 20px;\n}\ndiv#cems__call__content {\n  position: relative;\n  width: 315px;\n  height: 385px;\n  align-items: center;\n  justify-content: center;\n  display: flex;\n  flex-direction: column;\n  background: #ebe7e7;\n  border-radius: 10px;\n}\n\ndiv#cems__call__content h3 {\n  top: 20px;\n  font-size: 18px;\n}\n.cems__callButtons {\n  bottom: 20px;\n  width: 100%;\n  left: 0;\n  z-index: 5555555555555;\n}\nh4#callingType {\n  font-size: 13px;\n  margin: 6px 0px 20px 0;\n}\n.cems__callButtons img {\n  width: 45px !important;\n  cursor: pointer;\n  margin: 10px;\n  padding: 12px;\n  border-radius: 50%;\n}\nimg.bs__cancleCallBtn {\n  background: #ffffff;\n  transform: rotate(-90deg);\n}\nimg.bs__reciveAudioCall {\n  background: #ffffff;\n  transform: rotate(-90deg);\n}\nimg.bs__muteAudio {\n  background: white;\n}\n#cems_shareScreenBtn {\n  background: white;\n}\n.bs__videoOff {\n  background: white;\n}\n.cems__callImage {\n  width: 100px;\n  background: #b8c9cf;\n  height: 100px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  border-radius: 50%;\n  font-size: 39px;\n  font-weight: 600;\n  color: #ffffff;\n  margin-bottom: 30px;\n}\n.cems__callButtons button {\n  padding: 10px;\n  margin: 10px;\n}\n\n.cems__callImage img {\n  width: 86px;\n}\n.cems__callButtons svg {\n  width: 50px !important;\n  cursor: pointer;\n  margin: 10px;\n  padding: 0;\n  height: auto;\n}\n/* **********reciveCall************* */\n#cems__recivedcall__content {\n  position: relative;\n  width: 90%;\n  height: 90%;\n  align-items: center;\n  justify-content: center;\n  display: flex;\n  flex-direction: column;\n  background: rgb(65, 65, 65);\n  border-radius: 10px;\n}\ndiv#cems__call__sender {\n  position: absolute;\n  width: 19%;\n  height: 23%;\n  top: 2%;\n  right: 2%;\n  z-index: 555555555;\n  border-radius: 10px;\n  border: 1px solid white;\n  background: gray;\n}\n\ndiv#cems__call__reciver div,\ndiv#cems__call__sender div {\n  justify-content: center;\n  border-radius: 20px;\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  align-items: center;\n  display: flex;\n  color: white;\n}\ndiv#cems__call__reciver {\n  width: 100%;\n  height: 100%;\n  border-radius: 20px !important;\n  z-index: 55555555;\n  border: 1px solid white;\n  background: gray;\n}\ndiv#cams__call__timer {\n  z-index: 5555555555;\n  color: #0f991e;\n  font-size: 13px;\n  font-weight: bold;\n  bottom: 89px;\n  margin: 6px 0px 20px 0;\n}\n',styleSheet=document.createElement("style");styleSheet.type="text/css",styleSheet.innerText=cssstyles,document.head.appendChild(styleSheet);let calleeId="s",calleeName="",clickFriendId="",selectFile=void 0,unreadMessageId=[],inMessages=!1,rtmClient=null,options={channel:"143142",uid:143},allDetails={userName:"",userId:"",access_token:""},newChatList=[],chatListData=[],friendList=[];window.addEventListener("beforeunload",(function(e){localStorage.setItem(`CemsChatDataFor${allDetails.userId}`,JSON.stringify(chatListData))}));let fetchData=(uid,allMessage=[])=>{let testd=[];allMessage.map(am=>{let strStart=am.text[0],strEnd=am.text[am.text.length-1];if("["===strStart&&"]"===strEnd){let parseAm;JSON.parse(am.text).map(d=>{let isa=!0;testd.map(td=>{d.id===td.id&&(td.messages=[...td.messages,...d.messages],isa=!1)}),!0===isa&&testd.unshift(d)})}else console.log(strStart,am.text[am.text.length-2])});let data=JSON.parse(localStorage.getItem(`CemsChatDataFor${uid}`));null===data||(chatListData=void 0===data?[]:data)},addchangeUser=uid=>{if("vexpo-242"===uid){let withoutData=chatListData.filter(data=>data.chat_uid!==uid),alData=chatListData.find(data=>"vexpo-243"==data.chat_uid);chatListData=withoutData,void 0===alData&&chatListData.push({name:"user4",id:"vexpo-243",messages:[]})}else{let withoutData=chatListData.filter(data=>data.chat_uid!=uid),alData=chatListData.find(data=>"vexpo-242"==data.chat_uid);chatListData=withoutData,void 0===alData&&chatListData.push({name:"User3",id:"vexpo-242",messages:[]})}},getCurrentDateTime=()=>{var myDate=new Date;let daysList=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthsList=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Aug","Oct","Nov","Dec"],date=myDate.getDate(),month=monthsList[myDate.getMonth()],year=myDate.getFullYear(),day=daysList[myDate.getDay()],today,amOrPm,twelveHours,hours,minutes,currentTime,currentDateTime;return`${`${date} ${month} ${year}`} | ${`${function(){if(myDate.getHours()>12){let twentyFourHourTime,conversion;return amOrPm="PM",`${myDate.getHours()-12}`}return amOrPm="AM",`${myDate.getHours()}`}()}:${myDate.getMinutes()} ${amOrPm}`}`};class agoraFuntionality{constructor(getModalSection){this.sections={getModalSection:getModalSection,getCallingType:null},this.localTracks={localAudioTrack:null,localVideoTrack:null},this.mute=!1,this.rtcClient=null,this.uid="",this.userName="",this.appId="",this.rtmToken="",this.channelId="",this.rtcToken="",this.rtmClient="",this.status="ofline",this.remoteInvitation=null,this.localInvitation=null,this.rington="https://file-examples-com.github.io/uploads/2017/11/file_example_MP3_700KB.mp3",this.collerTune="https://audio.jukehost.co.uk/2OdnBtHkBRWn76r6YiNesNpb5PTNEg5b",this.tokenUrl="http://47.241.99.15:5000",this.appCertificate=""}hidecall(res){this.stopCallerTune(),this.stopRington(),this.sections.getCallingType.innerHTML=res,document.getElementsByClassName("cems__callButtons")[0].style.display="none",setTimeout(()=>{this.status="online",this.sections.getModalSection.style.display="none"},1e3)}playRington(){this.rington.play()}stopRington(){this.rington.pause(),this.rington.currentTime=0}playCallerTune(){this.callerTune.play()}stopCallerTune(){this.callerTune.pause(),this.currentTime=0}async logout(){this.rtmClient.logout().then(()=>{document.getElementById("cems__chatbox__button").classList.add("cems__hide__section")})}async login(uid,name,appId,access_token){this.uid=uid,this.appId=appId,this.userName=name,this.rtmToken=await this.createAgoraRtmToken(uid),this.rtmClient=AgoraRTM.createInstance(appId),rtmClient=this.rtmClient,await this.rtmClient.login({uid:uid,token:this.rtmToken}).then(async()=>{this.peerMessageRecive(),this.RemoteInvitationReceived(),this.status="online",allDetails.userName=name,allDetails.userId=uid,allDetails.access_token=access_token,document.getElementById("cems__chatbox__button").classList.remove("cems__hide__section"),fetchData(uid),gotoChatList(),friendList=await getFriendListData(access_token,uid)}).catch(err=>{console.log(err)})}init(uid,name,appId,access_token,rington,callerTune,tokenUrl,appCertificate){null!=tokenUrl&&(this.tokenUrl=tokenUrl),null!=rington&&(this.rington=new Audio(rington)),null!=callerTune&&(this.callerTune=new Audio(callerTune)),this.appCertificate=appCertificate,this.login(uid.toString(),name,appId,access_token)}async createAgoraRtmToken(userName){try{const response=await axios.get(`${this.tokenUrl}/token/?username=${userName}&channelName=${userName}&appID=${this.appId}&appCertificate=${this.appCertificate}`);return await response.data.rtmToken}catch(error){console.error(error)}}async createAgoraRtcToken(id){this.callid=id;try{const response=await axios.get(`${this.tokenUrl}/rtc-uid-token/?uid=${id}&channelName=${this.channelId}&appID=${this.appId}&appCertificate=${this.appCertificate}`);return await response.data.token}catch(error){console.error(error)}}async sendPeerMessage(message,peerId){scrollBottom(),"call"!=message.type&&await this.rtmClient.sendMessageToPeer({text:message.text},peerId.toString()).then(sendResult=>{sendResult.hasPeerReceived?console.log("message recived"):console.log("message send")})}async checkPeerOnlineStatus(peerId){return await this.rtmClient.queryPeersOnlineStatus([peerId.toString()]).then(res=>res[peerId.toString()])}peerMessageRecive(){this.rtmClient.on("MessageFromPeer",(async function(message,peerId,proper){let withOutUnreadMessageId=unreadMessageId.filter(id=>id!=peerId);unreadMessageId=[...withOutUnreadMessageId,peerId],"call"!==message.messageType&&reciveMessageStoreAndOutput(message,peerId),chatbox.unreadMessageCountDisplay(),chatbox.inChatList=!0,chatbox.chatListOrUserEffect()}))}scrollTop(){var chatEl=document.getElementById("cems__chatbox__messages");chatEl.scrollTop=chatEl.scrollHeight}audioVideoCall=async type=>{null!=this.localInvitation&&(this.localInvitation.removeAllListeners(),this.localInvitation=null),this.localInvitation=this.rtmClient.createLocalInvitation(calleeId.toString()),this.localInvitationEvents(),this.channelId=this.uid,this.localInvitation._channelId=this.uid,this.localInvitation._content=type,this.calltype=type,this.localInvitation.send(),this.sections.getModalSection.innerHTML=outgoinCallOutput(type),this.sections.getCallingType=document.getElementById("callingType"),this.status="busy",this.sections.getModalSection.style.display="flex",sendMessage(calleeId,{text:`You gave ${calleeName} a ${type} call `,type:"call",time:getCurrentDateTime(),mediaUrl:void 0,mediaId:void 0,mediaName:void 0}),this.rtcToken=await this.createAgoraRtcToken(1),this.joinReciveCallReciver(this.calltype)};localInvitationEvents=()=>{this.localInvitation.on("LocalInvitationReceivedByPeer",r=>{this.sections.getCallingType.innerHTML=`Calling ${calleeName}`,this.playCallerTune()}),this.localInvitation.on("LocalInvitationAccepted",r=>{this.stopCallerTune(),this.joinReciveCallSender(this.calltype),recivedCallOutput(this.calltype)}),this.localInvitation.on("LocalInvitationCanceled",r=>{console.log("LocalInvitationCanceled"+r)}),this.localInvitation.on("LocalInvitationRefused",r=>{this.hidecall(`${calleeName} busy now`)}),this.localInvitation.on("LocalInvitationFailure",r=>{this.hidecall(r)})};cancelOutgoingCall(){this.localInvitation.cancel(),this.stopCallerTune(),this.status="online",this.sections.getModalSection.style.display="none"}async RemoteInvitationReceived(){this.rtmClient.on("RemoteInvitationReceived",async remoteInvitation=>{"online"==this.status?(null!=this.remoteInvitation&&(this.remoteInvitation.removeAllListeners(),this.remoteInvitation=null),this.remoteInvitation=remoteInvitation,this.channelId=remoteInvitation._channelId,this.rtcToken=await this.createAgoraRtcToken(2),this.calltype=remoteInvitation._content.toLowerCase(),this.caller=friendList.find(f=>f.chat_uid===remoteInvitation.callerId),incomingCallOutput(this.caller.name,this.calltype,remoteInvitation.callerId),this.sections.getCallingType=document.getElementById("callingType"),this.status="busy",this.sections.getModalSection.style.display="flex",this.peerEvents(),reciveMessageStoreAndOutput({text:`${this.caller.name} called You`,messageType:"call"},remoteInvitation.callerId),this.joinReciveCallReciver(this.calltype),this.playRington()):remoteInvitation.refuse()})}peerEvents=()=>{this.remoteInvitation.on("RemoteInvitationReceived",r=>{console.log("RemoteInvitationReceived"+r)}),this.remoteInvitation.on("RemoteInvitationAccepted",r=>{this.stopRington(),this.joinReciveCallSender(this.calltype),recivedCallOutput(this.calltype)}),this.remoteInvitation.on("RemoteInvitationCanceled",r=>{this.hidecall(`${this.caller.name} canceled the call`)}),this.remoteInvitation.on("RemoteInvitationRefused",r=>{this.hidecall(),console.log("RemoteInvitationRefused "+r)}),this.remoteInvitation.on("RemoteInvitationFailure",r=>{this.hidecall(r)})};cancelIncomingCall(){this.remoteInvitation.refuse(),this.status="online",this.sections.getModalSection.style.display="none"}reciveIncomingCall(){this.remoteInvitation.accept()}async joinReciveCallReciver(type){this.rtcClient=AgoraRTC.createClient({mode:"rtc",codec:"vp8"}),this.rtcClient.on("user-published",async(user,mediaType)=>{if(await this.rtcClient.subscribe(user,mediaType),console.log("subscribe success"),"video"==type&&"video"===mediaType){const remoteVideoTrack=user.videoTrack,fricon=document.getElementById("cems__call__reciver");remoteVideoTrack.play(fricon)}if("audio"===mediaType){const remoteAudioTrack=user.audioTrack;remoteAudioTrack.play()}this.rtcClient.on("user-unpublished",async(user,mediaType)=>{console.log("unpublish",user,mediaType)}),this.rtcClient.on("user-info-updated",async(user,msg)=>{console.log("updated",user,msg)}),this.rtcClient.on("user-left",async(user,res)=>{this.localTracks.localAudioTrack.close(),this.localTracks.localVideoTrack&&this.localTracks.localVideoTrack.close(),this.localTracks.screenVideoTrack&&this.localTracks.screenVideoTrack.close(),await this.rtcClient.leave(),this.sections.getModalSection.style.display="none",this.status="online",clearInterval(callInterval),mute=!1})})}async joinReciveCallSender(type){if(await this.rtcClient.join(this.appId,this.channelId,this.rtcToken,this.callid),this.localTracks.localAudioTrack=await AgoraRTC.createMicrophoneAudioTrack(),"video"==type){this.localTracks.localVideoTrack=await AgoraRTC.createCameraVideoTrack(),await this.rtcClient.publish([this.localTracks.localAudioTrack,this.localTracks.localVideoTrack]);const mycon=document.getElementById("cems__call__sender");this.localTracks.localVideoTrack.play(mycon)}else await this.rtcClient.publish([this.localTracks.localAudioTrack]);console.log("publish success!")}muteAudio(){this.localTracks.localAudioTrack.close()}async unmuteAudio(){this.localTracks.localAudioTrack=await AgoraRTC.createMicrophoneAudioTrack(),await this.rtcClient.publish([this.localTracks.localAudioTrack])}async screenshareOn(){this.localTracks.screenVideoTrack=await AgoraRTC.createScreenVideoTrack(),this.localTracks.localVideoTrack&&(await this.rtcClient.unpublish([this.localTracks.localVideoTrack]),this.localTracks.localVideoTrack.close()),await this.rtcClient.publish([this.localTracks.screenVideoTrack]);const mycon=document.getElementById("cems__call__sender");let getscreenShareBtn;this.localTracks.screenVideoTrack.play(mycon),document.getElementById("cems_shareScreenBtn").src="https://img.icons8.com/ios-filled/80/0998f5/screensharing.png",this.localTracks.screenVideoTrack.on("track-ended",async()=>{screenshare()})}async screenshareOff(){this.rtcClient.unpublish([this.localTracks.screenVideoTrack]),this.localTracks.screenVideoTrack.close(),this.localTracks.localVideoTrack=await AgoraRTC.createCameraVideoTrack(),await this.rtcClient.publish([this.localTracks.localVideoTrack]);const mycon=document.getElementById("cems__call__sender");this.localTracks.localVideoTrack.play(mycon)}async leaveReciveCall(){this.localTracks.localVideoTrack&&this.localTracks.localVideoTrack.close(),this.localTracks.screenVideoTrack&&this.localTracks.screenVideoTrack.close(),this.localTracks.localAudioTrack.close(),await this.rtcClient.leave(),this.sections.getModalSection.style.display="none",this.status="online",clearInterval(callInterval),mute=!1}fileOrBlobToDataURL=(obj,cb)=>{var a=new FileReader;a.readAsDataURL(obj),a.onload=function(e){cb(e.target.result)}};blobToImage=(blob,cb)=>{this.fileOrBlobToDataURL(blob,(function(dataurl){var img=new Image;img.src=dataurl,cb(img)}))};reciveFileControl=async mediaId=>{let fileBlob;return await rtmClient.downloadMedia(mediaId,{onOperationProgress:({currentSize:currentSize,totalSize:totalSize})=>{let downloadPercent=Math.round(currentSize/totalSize*50);percent=50+downloadPercent,console.log(percent)}})}}let getModalSection=document.getElementById("cems__myModal"),agoraFunction=new agoraFuntionality(getModalSection),cancelOutgoingCall=()=>{agoraFunction.cancelOutgoingCall()},reciveIncomingCall=()=>{agoraFunction.reciveIncomingCall()},cancelIncoingCall=()=>{agoraFunction.cancelIncomingCall()},cancelRecivedCall=()=>{agoraFunction.leaveReciveCall()},screenShare=!1,screenshare=()=>{let getscreenShareBtn=document.getElementById("cems_shareScreenBtn");!1!==screenShare?(agoraFunction.screenshareOff(),getscreenShareBtn.src="https://img.icons8.com/dotty/80/0998f5/screensharing.png"):agoraFunction.screenshareOn(),screenShare=!screenShare},createRecivedMessageOutput=(message,peerId)=>{let createMessageOutput=document.createElement("div"),createTimeOutput=document.createElement("div");if(createTimeOutput.className="cems__messages__time-visitor",createTimeOutput.innerHTML=`${message.time}`,"TEXT"===message.messageType||"call"===message.messageType)createMessageOutput.className="cems__messages__item cems__messages__item--visitor",createMessageOutput.innerHTML=`${message.text}`;else{let fileLink=message.mediaUrl,fileName=message.mediaName;"IMAGE"===message.messageType?(createMessageOutput.className="cems__messages__item cems__messages__item--visitor_image",createMessageOutput.innerHTML=` <a href="${fileLink}" download target="_blank">\n      <img src="${fileLink}" alt="" style="width:125px">\n      </a>`):(createMessageOutput.className="cems__messages__item cems__messages__item--visitor",createMessageOutput.innerHTML=` <a href="${fileLink}" download target="_blank">\n      <img src="https://img.icons8.com/carbon-copy/100/000000/file.png" style="width:70px"/><br>\n          <a href="${fileLink}" download target="_blank">${fileName}</a>\n      </a>`)}let className=peerId,isClass=document.getElementsByClassName(`cems__messageFor${className}`)[0];1==inMessages&&null!=isClass&&(unreadMessageId=unreadMessageId.filter(uid=>uid!=peerId),isClass.appendChild(createMessageOutput),isClass.appendChild(createTimeOutput))},mute=!1,mutecontrol=()=>{let getMuteButton=document.getElementById("muteMicrophone");!1!==mute?(agoraFunction.unmuteAudio(),getMuteButton.src="https://img.icons8.com/external-kiranshastry-lineal-kiranshastry/100/0998f5/external-microphone-interface-kiranshastry-lineal-kiranshastry.png"):(agoraFunction.muteAudio(),getMuteButton.src="https://img.icons8.com/material-rounded/96/000000/block-microphone.png"),mute=!mute},videoshare=!1,videoControl=()=>{let getVideoMuteBtn=document.getElementById("cems_videomuteBtn");getVideoMuteBtn.innerHTML=0==videoshare?'<svg class="cems__reciveBtn" onclick=videoControl() xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="96" height="96" viewBox="0 0 172 172" style=" fill:#000000;"><g fill="none" fill-rule="nonzero" stroke="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="10" stroke-dasharray="" stroke-dashoffset="0" font-family="none" font-weight="none" font-size="none" text-anchor="none" style="mix-blend-mode: normal"><path d="M0,172v-172h172v172z" fill="none"></path><path d="M86,172c-47.49649,0 -86,-38.50351 -86,-86v0c0,-47.49649 38.50351,-86 86,-86v0c47.49649,0 86,38.50351 86,86v0c0,47.49649 -38.50351,86 -86,86z" fill="#e74c3c"></path><g fill="#ffffff"><path d="M41.77143,51.6c-5.42046,0 -9.82857,4.40811 -9.82857,9.82857v49.14286c0,5.42046 4.40811,9.82857 9.82857,9.82857h63.88571c5.42046,0 9.82857,-4.40811 9.82857,-9.82857v-14.33973l16.58571,13.26473c0.88949,0.70766 1.97554,1.075 3.07143,1.075c0.7224,0 1.45263,-0.16516 2.1308,-0.48951c1.70526,-0.81577 2.78348,-2.53769 2.78348,-4.42478v-39.31429c0,-1.88709 -1.07822,-3.61369 -2.78348,-4.43438c-1.70034,-0.81086 -3.72795,-0.58434 -5.20223,0.59509l-16.58571,13.26473v-14.33973c0,-5.42046 -4.40811,-9.82857 -9.82857,-9.82857z"></path></g></g></svg>':'<svg class="cems__reciveBtn" onclick=videoControl() xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="96" height="96" viewBox="0 0 172 172" style=" fill:#000000;"><g fill="none" fill-rule="nonzero" stroke="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="10" stroke-dasharray="" stroke-dashoffset="0" font-family="none" font-weight="none" font-size="none" text-anchor="none" style="mix-blend-mode: normal"><path d="M0,172v-172h172v172z" fill="none"></path><path d="M86,172c-47.49649,0 -86,-38.50351 -86,-86v0c0,-47.49649 38.50351,-86 86,-86v0c47.49649,0 86,38.50351 86,86v0c0,47.49649 -38.50351,86 -86,86z" fill="#2aa826"></path><g fill="#ffffff"><path d="M53.93429,61.06c-3.92983,0 -7.12571,3.19588 -7.12571,7.12571v35.62857c0,3.92983 3.19588,7.12571 7.12571,7.12571h46.31714c3.92983,0 7.12571,-3.19588 7.12571,-7.12571v-10.39631l12.02464,9.61693c0.64488,0.51305 1.43227,0.77937 2.22679,0.77937c0.52374,0 1.05316,-0.11974 1.54483,-0.35489c1.23631,-0.59143 2.01802,-1.83983 2.01802,-3.20796v-28.50286c0,-1.36814 -0.78171,-2.61992 -2.01802,-3.21492c-1.23275,-0.58787 -2.70276,-0.42365 -3.77162,0.43144l-12.02464,9.61693v-10.39631c0,-3.92983 -3.19588,-7.12571 -7.12571,-7.12571z"></path></g></g></svg>',videoshare=!videoshare},recivedCallOutput=type=>{let output=`\n  <div id="cems__callsection">\n       \n       ${"video"==type?'<div id="cems__recivedcall__content">\n          <div id="cams__call__timer" style=\'position: absolute; color:white\'><span id="minutes"></span>:<span id="seconds"></span></div>\n         <div id="cems__call__sender">\n          <div>\n            <p>Your camera off</p>\n          </div>\n         </div>\n         <div id="cems__call__reciver">\n          <div>\n            <p>Your friend\'s camera off</p>\n          </div>\n          </div>':`<div id="cems__call__content">\n         <h3 class="bs__calleeName">${calleeName}</h3>\n         <div id="cams__call__timer"><span id="minutes"></span>:<span id="seconds"></span></div>\n         <div  class="cems__callImage" >\n         <p class="bs__calleIcon">${calleeName.toUpperCase().charAt(0)}</p>\n       </div>\n         `}\n       \n         <div class="cems__callButtons" ${"video"===type?"style='position: absolute'":""} >\n         ${"video"===type?"<img class='bs__videoOff' src='https://img.icons8.com/material-outlined/96/0998f5/video-call.png'/>":""}\n         <img class="bs__cancleCallBtn" onclick=cancelRecivedCall() src="https://img.icons8.com/windows/96/FF0000/phone-disconnected--v1.png">\n         \n        <img id="muteMicrophone" class="bs__muteAudio"  onclick=mutecontrol()  src="https://img.icons8.com/external-kiranshastry-lineal-kiranshastry/100/0998f5/external-microphone-interface-kiranshastry-lineal-kiranshastry.png"/>\n        \n         ${"video"==type?'<img id="cems_shareScreenBtn"  onclick=screenshare() src="https://img.icons8.com/dotty/80/0998f5/screensharing.png"/>\n           ':""} </div>\n         \n       </div>\n   </div>\n  `;getModalSection.innerHTML=output,callTimer()},callInterval,callTimer=()=>{var sec=0;function pad(val){return val>9?val:"0"+val}callInterval=setInterval((function(){document.getElementById("seconds").innerHTML=pad(++sec%60),document.getElementById("minutes").innerHTML=pad(parseInt(sec/60,10))}),1e3)},outgoinCallOutput=type=>`\n  <div id="cems__callsection">\n       <div id="cems__call__content">\n         <h3 class="bs__calleeName">${calleeName}</h3>\n         <h4 id='callingType'> Outgoing ${""===type?"audio":"video"} call... </h4>\n         <div  class="cems__callImage" >\n         <p class="bs__calleIcon">${calleeName.toUpperCase().charAt(0)}</p>\n        </div>\n         <div class="cems__callButtons" >\n         ${"video"===type?"<img class='bs__videoOff' src='https://img.icons8.com/material-outlined/96/0998f5/video-call.png'/>":""}\n         <img class="bs__cancleCallBtn" onclick=cancelOutgoingCall() src="https://img.icons8.com/windows/96/FF0000/phone-disconnected--v1.png">\n         <img class="bs__muteAudio"  src="https://img.icons8.com/external-kiranshastry-lineal-kiranshastry/100/0998f5/external-microphone-interface-kiranshastry-lineal-kiranshastry.png"/>\n         </div>\n       </div>\n   </div>\n  `,incomingCallOutput=(name,type,peerId)=>{let withOutUnreadMessageId=unreadMessageId.filter(id=>id!=peerId);unreadMessageId=[...withOutUnreadMessageId,peerId],calleeName=name;let output=`\n  <div id="cems__callsection">\n       <div id="cems__call__content">\n       <h3 class="bs__calleeName">${calleeName}</h3>\n       <h4 id='callingType'> Incoming ${""===type?"audio":"video"} call... </h4>\n       <div  class="cems__callImage" >\n       <p class="bs__calleIcon">${calleeName.toUpperCase().charAt(0)}</p>\n      </div>\n         <div class="cems__callButtons">\n         ${"video"===type?"<img class='bs__videoOff' src='https://img.icons8.com/material-outlined/96/0998f5/video-call.png'/>":""}\n         <img class="bs__cancleCallBtn" onclick=cancelIncoingCall() src="https://img.icons8.com/windows/96/FF0000/phone-disconnected--v1.png">\n            <img class="bs__reciveAudioCall" onclick=reciveIncomingCall() src="https://img.icons8.com/windows/96/4FBC87/phone-disconnected--v1.png">\n             \n         <img class="bs__muteAudio"  src="https://img.icons8.com/external-kiranshastry-lineal-kiranshastry/100/0998f5/external-microphone-interface-kiranshastry-lineal-kiranshastry.png"/>\n           \n         </div>\n       </div>\n   </div>\n  `;getModalSection.innerHTML=output},storeMessage=(message,peerId)=>{let peerDetails=friendList.find(d=>d.chat_uid==peerId);chatListDataStore(message,peerId,peerDetails.name,"recive"),createRecivedMessageOutput(message,peerId),scrollBottom(),gotoChatList();var chatEl=document.getElementById("cems__chatbox__messages");chatEl.scrollTop=chatEl.scrollHeight},reciveMessageStoreAndOutput=async(message,peerId)=>{let currentDateTime=getCurrentDateTime();if("TEXT"===message.messageType||"call"===message.messageType)(message=message).messageType=message.messageType,message.time=currentDateTime,storeMessage(message,peerId);else{let blob=await agoraFunction.reciveFileControl(message.mediaId);await agoraFunction.blobToImage(blob,async file=>{message={messageType:message.messageType,text:"",time:currentDateTime,mediaId:message.mediaId,mediaUrl:file.src,mediaName:message.fileName},storeMessage(message,peerId)})}},getChatData=async(authToken,uid)=>{try{let response=await axios.get(`https://tradazine.com/api/v1/all-chat-message/${uid}`,{headers:{Authorization:`Bearer ${authToken}`}});return await response}catch(err){console.error(err)}},getFriendListData=async(authToken,uid)=>{if(null===authToken){let friendList=[{chat_uid:"user1@gmail.com",name:"user1@gmail.com"},{chat_uid:"user2@gmail.com",name:"user2@gmail.com"},{chat_uid:"user3@gmail.com",name:"user3@gmail.com"},{chat_uid:"user4@gmail.com",name:"user4@gmail.com"}];return friendList=friendList.filter(d=>d.chat_uid!=uid),friendList}try{let response=await axios.get("https://tradazine.com/api/v1/get-all-users",{headers:{Authorization:`Bearer ${authToken}`}}),friendlist=await response.data.data.filter(d=>d.chat_uid!=uid),isTecnicalHelp;return void 0===friendList.find(f=>"tecnicalhelp"===f.chat_uid)&&friendlist.push({id:"technicalhelp",chat_uid:"technicalhelp",name:"technicalhelp"}),await friendlist}catch(err){console.error(err)}},chatListsDiv=document.getElementById("cems__all__chatlist"),chatboxChattingDiv=document.getElementById("cems__chatbox__chatting"),chatlistHeaderText=document.getElementById("cems__chatlist__header__text"),chatboxMessagesDiv=document.getElementById("cems__chatbox__messages"),scrollBottom=()=>{var chatEl=document.getElementById("cems__chatbox__messages");chatEl.scrollTop=chatEl.scrollHeight},usersToggle=data=>{let element=`\n    <div class="cems__chat__list" id='${data.chat_uid}' onclick={showMesseges(this.id)}>\n    <div class="cems__friend__icon">\n      <p>${data.name.toUpperCase().charAt(0)}</p>\n    </div>\n    <div class="cems__chatlist__content">\n      <h4 class="cems__chatlist__friendName">${data.name}</h4>\n    </div>\n  </div>\n    `;return chatListsDiv.innerHTML+=element},chatsToggle=data=>{let lastMessageDetails=data.messages.pop(),lastMessage="";null!=lastMessageDetails&&(data.messages.push(lastMessageDetails),lastMessage=2==lastMessageDetails.messageType?"call"===lastMessageDetails.type||"TEXT"===lastMessageDetails.type?`You : ${lastMessageDetails.text}`:"You : Send a file ":"call"===lastMessageDetails.type||"TEXT"===lastMessageDetails.type?lastMessageDetails.text:" Send a file");let isUnread,setclass="";null!=unreadMessageId.find(id=>id==data.chat_uid)&&(setclass="unseen__message");let timeStamp="";void 0!==lastMessageDetails&&null!==lastMessageDetails.timeStamp&&void 0!==lastMessageDetails.timeStamp&&(timeStamp=lastMessageDetails.timeStamp.split("|")[1]);let element=`\n    <div class="cems__chat__list ${setclass}" id='${data.chat_uid}' onclick={showMesseges(this.id)}>\n      <div class="cems__friend__icon">\n        <h3>${data.name.toUpperCase().charAt(0)}</h3>\n      </div>\n      <div class="cems__chatlist__content">\n        <div class="cems__chatlist_fNameAndMessage">\n          <h4 class="cems__chatlist__friendName">${data.name}</h4>\n          <p class="chatListLastMessage"> ${lastMessage}</p>\n        </div>\n        <div class="cems__chatlist__time">\n         <p  class="chatListLastMessageTime"> ${timeStamp}</p>\n        </div>\n      </div>\n      \n    </div>\n    `;return chatListsDiv.innerHTML+=element},gotoChatList=()=>{let className=calleeId;chatListsDiv.innerHTML="",chatlistHeaderText.innerText="Chats",chatListData.length<1?chatListsDiv.innerHTML='<p class="cems__no_found">No Chats found</p>':chatListData.map(data=>{chatsToggle(data)})},gotoUsers=()=>{chatbox.gotoUsers(),chatListsDiv.innerHTML="",chatlistHeaderText.innerText="Users",friendList.length<1?chatListsDiv.innerHTML='<p class="cems__no_found">No Friend found</p>':friendList.map(data=>{usersToggle(data)})};async function showMesseges(id){inMessages=!0;let exactData=chatListData.find(data=>data.chat_uid==id);null==exactData&&(exactData=friendList.find(data=>data.chat_uid==id),exactData.messages=[]),calleeId=exactData.chat_uid,unreadMessageId=unreadMessageId.filter(id=>id!=exactData.chat_uid),calleeName=exactData.name,chatboxChattingDiv.innerHTML=chatboxChating(exactData),sendMessageWithEnterKey(),chatbox.gotoChat(),filesend(),imageAndFileQuery();let onlineStatus=await agoraFunction.checkPeerOnlineStatus(exactData.chat_uid),onlineOrOflineIcon=document.getElementById("cems__onlineOrOfflineIcon"),onlineOrOflineText=document.getElementById("cems__onlineOrOfflineText");onlineStatus?(onlineOrOflineIcon.classList.remove("cems__offlineIcon"),onlineOrOflineIcon.classList.add("cems__onlineIcon"),onlineOrOflineText.classList.remove("cems__offlineText"),onlineOrOflineText.classList.add("cems__onlineText"),onlineOrOflineText.innerText="Active now"):(onlineOrOflineIcon.classList.add("cems__offlineIcon"),onlineOrOflineIcon.classList.remove("cems__onlineIcon"),onlineOrOflineText.classList.add("cems__offlineText"),onlineOrOflineText.classList.remove("cems__onlineText"),onlineOrOflineText.innerText="Offline"),exactData.messages.length&&controlSentOrReciveMessage(exactData)}let backToChatList=()=>{inMessages=!1,gotoChatList(),chatbox.backTochatList()},controlSentOrReciveMessage=data=>{let chatboxMessages=document.createElement("ul");return chatboxMessages.innerHTML="",data.messages.map(m=>{let chatboxMessageTime=type=>{chatboxMessages.innerHTML+=`<div class="cems__messages__time-${type}">${m.timeStamp}</div>`},message=m.text;if(2==m.messageType)if("FILE"===m.type||"IMAGE"===m.type){let fileLink=m.mediaUrl,fileName=m.mediaName;"IMAGE"===m.type?(chatboxMessages.innerHTML+=`<div class="cems__messages__item cems__messages__item--operator_image">\n<a href="${fileLink}" download target="_blank">\n        <img src="${fileLink}" alt="" style="width:125px">\n        </a>\n      </div>`,chatboxMessageTime("operator")):(chatboxMessages.innerHTML+=`<div class="cems__messages__item cems__messages__item--operator"  >\n      <a href="${fileLink}" download target="_blank">\n      <img src="https://img.icons8.com/carbon-copy/100/000000/file.png" style="width:70px"/><br>\n      <a href="${fileLink}" download target="_blank" style="color:#ffecec">${fileName}</a>\n      </a>\n      </div>`,chatboxMessageTime("operator"))}else chatboxMessages.innerHTML+=`<div class="cems__messages__item cems__messages__item--operator">${m.text}</div>`,chatboxMessageTime("operator");else if("FILE"===m.type||"IMAGE"===m.type){let fileLink=m.mediaUrl,fileName=m.mediaName;"IMAGE"===m.type?(chatboxMessages.innerHTML+=`<div class="cems__messages__item cems__messages__item--visitor_image" >\n          <a href="${fileLink}" download target="_blank">\n          <img src="${fileLink}" alt="" style="width:125px">\n          </a>\n      </div>`,chatboxMessageTime("visitor")):(chatboxMessages.innerHTML+=`<div class="cems__messages__item cems__messages__item--visitor"  >\n      <a href="${fileLink}" download target="_blank">\n      <img src="https://img.icons8.com/carbon-copy/100/000000/file.png" style="width:70px"/><br>\n          <a href="${fileLink}" download target="_blank">${fileName}</a>\n      </a>\n      </div>`,chatboxMessageTime("visitor"))}else chatboxMessages.innerHTML+=`<div class="cems__messages__item cems__messages__item--visitor">${m.text}</div>`,chatboxMessageTime("visitor")}),document.getElementById("cems__chatbox__messages").innerHTML=chatboxMessages.innerHTML,scrollBottom(),chatboxMessages.innerHTML},getFileByMediaId=mediaId=>{},finalFileMessageOutput=(time,type,mediaMessage,src)=>{let createTimeOutput=document.createElement("div");createTimeOutput.className="cems__messages__time-operator",createTimeOutput.innerHTML=`${time}`;let fileLink=src,fileName=mediaMessage.fileName,createMessageOutputDiv=document.createElement("div");"IMAGE"===type?(createMessageOutputDiv.className="cems__messages__item cems__messages__item--operator_image",createMessageOutputDiv.innerHTML=`<a href="${fileLink}"  target="_blank">\n    <img src="${fileLink}" alt="" style="width:125px">\n    </a>`):(createMessageOutputDiv.className="cems__messages__item cems__messages__item--operator",createMessageOutputDiv.innerHTML=`<a href="${fileLink}"  target="_blank">\n    <img src="https://img.icons8.com/carbon-copy/100/000000/file.png" style="width:70px"/><br>\n    <a href="${fileLink}" download target="_blank" style="color:#ffecec">${fileName}</a>\n    </a>`),document.getElementById("cems__chatbox__messages").appendChild(createMessageOutputDiv),document.getElementById("cems__chatbox__messages").appendChild(createTimeOutput)},percent,createFileMessageOutput=async(mediaMessage,time,type)=>{let fileBlob=await rtmClient.downloadMedia(mediaMessage.mediaId,{onOperationProgress:({currentSize:currentSize,totalSize:totalSize})=>{downloadPercent=Math.round(currentSize/totalSize*50),percent=50+downloadPercent,console.log(percent)}});agoraFunction.blobToImage(fileBlob,async file=>{message={text:"",messageType:type,time:time,mediaId:mediaMessage.mediaId,mediaUrl:file.src,mediaName:mediaMessage.fileName},chatListDataStore(message,clickFriendId,allDetails.userName,"sent"),removeSelectFile();var image=new Image;image.src=file.src,mediaMessage.description=image,await rtmClient.sendMessageToPeer(mediaMessage,clickFriendId).then(sendResult=>{sendResult.hasPeerReceived?console.log("message recived"):console.log("message send"),finalFileMessageOutput(time,type,mediaMessage,file.src)}).catch(err=>{console.log(err.message),alert(err.message)}),document.getElementById("sendMessageBtn").disabled=!1,document.getElementById("sendMessageBtn").innerHTML='<img src="https://img.icons8.com/fluency-systems-regular/96/60A5FA/sent.png">'})},createTextMessageOutput=(message,time,type)=>{let createTimeOutput=document.createElement("div");if(createTimeOutput.className="cems__messages__time-operator",createTimeOutput.innerHTML=`${time}`,"IMAGE"===type||"FILE"===type)createFileMessageOutput(message,time,type);else{let createMessageOutputDiv=document.createElement("div");createMessageOutputDiv.className="cems__messages__item cems__messages__item--operator",createMessageOutputDiv.innerHTML=`${message}`,document.getElementById("cems__chatbox__messages").appendChild(createMessageOutputDiv),document.getElementById("cems__chatbox__messages").appendChild(createTimeOutput)}},sendMessageWithEnterKey=()=>{let cems__input__message;document.getElementById("cems__input__message").addEventListener("keyup",(function(event){13===event.keyCode&&(event.preventDefault(),sendMessage())}))},isImage=!1,sendFileMessage=async(id,message=null)=>{document.getElementById("sendMessageBtn").disabled=!0,document.getElementById("sendMessageBtn").innerHTML='<div class="bs__loader"></div>',id=clickFriendId;let currentDateTime=getCurrentDateTime();const fileToBlob=async file=>new Blob([new Uint8Array(await file.arrayBuffer())],{type:file.type});let blobF=await fileToBlob(selectFile),mediaMessage=await rtmClient.createMediaMessageByUploading(blobF,{messageType:isImage?"IMAGE":"FILE",fileName:selectFile.name},{onOperationProgress:({currentSize:currentSize,totalSize:totalSize})=>{percent=Math.round(currentSize/totalSize*50),console.log(percent)}});createFileMessageOutput(mediaMessage,currentDateTime,isImage?"IMAGE":"FILE")},sendMessage=async(id,message=null)=>{id=clickFriendId;let currentDateTime=getCurrentDateTime();if(null==message&&(typeMessage=document.getElementById("cems__input__message").value,message={text:typeMessage,type:"TEXT",time:currentDateTime,mediaUrl:void 0,mediaId:void 0,mediaName:void 0},document.getElementById("cems__input__message").value=""),0==message.text.length&&null==selectFile)alert("write something");else if(null!=selectFile&&sendFileMessage(),0==message.text.length);else{let exactMessagesData=chatListDataStore(message,id,allDetails.userName,"sent");createTextMessageOutput(message.text,currentDateTime,message.type);var chatEl=document.getElementById("cems__chatbox__messages");chatEl.scrollTop=chatEl.scrollHeight,await agoraFunction.sendPeerMessage(message,exactMessagesData.chat_uid)}},filesend=()=>{document.getElementById("cems_file_upload").addEventListener("change",(function(e){if(selectFile=e.target.files[0],void 0===selectFile)document.getElementById("cems_send_message").innerHTML='<input id="cems__input__message" type="text" placeholder="Write a message..." autocomplete="off"/>';else{let fileName=e.target.files[0].name,fileExtention=fileName.split(".").pop().toLowerCase();fileName.length>30&&(fileName=fileName.substring(0,30)+"..."+fileExtention),document.getElementById("bs__image_fileSelect").style.left="-416px",document.getElementById("bs_input_file_output").style.left="16px","txt"===fileExtention||"pdf"===fileExtention?(isImage=!1,document.getElementById("bs_input_file_show_image").src="https://img.icons8.com/material-two-tone/96/60A5FA/file.png",document.getElementById("bs_input_file_show_name").innerText=fileName):(isImage=!0,document.getElementById("bs_input_file_show_image").src=URL.createObjectURL(selectFile),document.getElementById("bs_input_file_show_name").innerText="")}}))},chatListDataStore=(message,id,name,type)=>{let messageType;"call"!==message.type&&"TEXT"!==message.type||(message.messageType=message.type),messageType="sent"==type?2:3;let exactMessagesData=chatListData.find(d=>d.chat_uid==id);if(null==exactMessagesData)exactMessagesData=friendList.find(data=>data.id==id),void 0===exactMessagesData?(exactMessagesData=friendList.find(data=>data.chat_uid==id),exactMessagesData.messages=[{type:message.messageType,messageType:messageType,text:message.text,timeStamp:message.time,username:name,mediaUrl:message.mediaUrl,mediaId:message.mediaId,mediaName:message.mediaName}]):exactMessagesData.messages=[{type:message.messageType,messageType:messageType,text:message.text,timeStamp:message.time,username:name,mediaUrl:message.mediaUrl,mediaId:message.mediaId,mediaName:message.mediaName}],chatListData.unshift(exactMessagesData),document.getElementById("cems__chatbox__messages").innerHTML="";else{let withoutExactMessagesData=chatListData.filter(d=>d.chat_uid!=id);0==exactMessagesData.messages.length&&(document.getElementById("cems__chatbox__messages").innerHTML=""),exactMessagesData.messages.push({type:message.messageType,messageType:messageType,text:message.text,timeStamp:message.time,username:name,mediaUrl:message.mediaUrl,mediaId:message.mediaId,mediaName:message.mediaName}),chatListData=[exactMessagesData,...withoutExactMessagesData]}return exactMessagesData},imageAndFileQuery=()=>{document.getElementById("bs__imageSelect").addEventListener("click",()=>{document.getElementById("cems_file_upload").setAttribute("accept","image/*")}),document.getElementById("bs__anyFileSelect").addEventListener("click",()=>{document.getElementById("cems_file_upload").setAttribute("accept"," .pdf")})},showSelectFileVisibility=!1,removeSelectFile=()=>{selectFile=void 0,document.getElementById("bs_input_file_output").style.left="-416px",showSelectFileVisibility=!1,document.getElementById("selectFilePlusIcon").style.transform="rotate(0deg)",document.getElementById("bs__image_fileSelect").style.left="-416px"},showSelectFile=()=>{0==showSelectFileVisibility?(showSelectFileVisibility=!0,document.getElementById("bs__image_fileSelect").style.left="16px",document.getElementById("selectFilePlusIcon").style.transform="rotate(45deg)"):removeSelectFile()},chatboxChating=data=>(clickFriendId=data.chat_uid,`\n  <div class="cems__chatbox__header">\n    <div class="cems__chat__details">\n    <div id="cems__chatbox_backButton--header" onclick=backToChatList()>\n    <img src="https://img.icons8.com/material-outlined/96/000000/back--v1.png"/>\n    </div>\n    <div class="cems__chatHead__friend__icon">\n      <p>${data.name.toUpperCase().charAt(0)}</p>\n      <div id='cems__onlineOrOfflineIcon' class='cems__offlineIcon'></div>\n    </div>\n    <div class="cems__chatbox__content--header">\n      <h4 class="cems__chatbox__heading--header">${data.name}</h4>\n      <p id='cems__onlineOrOfflineText' class="cems__offlineText">Offline</p>\n    </div>\n  </div>\n  <div class="cems__chat__callicon">\n  <img  class="cems__chat__VideoCallicon" src="https://img.icons8.com/material-outlined/96/60A5FA/video-call.png" onmouseover="this.src='https://img.icons8.com/material-rounded/96/60A5FA/video-call.png'" onmouseout="this.src='https://img.icons8.com/material-outlined/96/60A5FA/video-call.png'" onclick=agoraFunction.audioVideoCall('video')>\n  <img class="cems__chat__audioCallicon" src="https://img.icons8.com/windows/96/60A5FA/phone-disconnected--v1.png" onmouseover="this.src='https://img.icons8.com/ios-filled/100/60A5FA/phone-disconnected.png'" onmouseout="this.src='https://img.icons8.com/windows/96/60A5FA/phone-disconnected--v1.png'" onclick=agoraFunction.audioVideoCall('')>\n  </div>\n</div>\n<div id="cems__chatbox__messages" class="cems__messageFor${data.chat_uid}">\n  ${data.messages.length?'<p class="cems__no_found">Loading....</p>':'<p class="cems__no_found">No message found</p>'}\n</div>\n<div id="bs__image_fileSelect">\n  <div id="bs__imageSelect">\n  <label for="cems_file_upload">\n  <img src="https://img.icons8.com/material-outlined/24/60A5FA/add-image.png"/>\n  <p>Image</p>\n  </div>\n</label>\n   <div id="bs__anyFileSelect">\n   \n<label for="cems_file_upload">\n   <img src="https://img.icons8.com/ios/50/60A5FA/add-file.png"/>\n   <p>File</p>\n</label>\n  </div>\n  \n</div>\n<div id="bs_input_file_output">\n  <img id="selectFileRemoveIcon" src="https://img.icons8.com/windows/96/60A5FA/plus.png " onclick=removeSelectFile()>\n  <div id='bs_input_file_show'>\n  <img id='bs_input_file_show_image' src=""/>\n  <p id='bs_input_file_show_name'></p>\n  </div>\n</div>\n\n<div class="cems__chatbox__footer_inmessage">\n<img id="selectFilePlusIcon" src="https://img.icons8.com/windows/96/60A5FA/plus.png " onclick=showSelectFile()>\n<input type="file" id="cems_file_upload"  name="cems_file_upload" style="display:none;">\n  \n  <div id="cems_send_message">\n  <input id="cems__input__message" type="text" placeholder="Write a message..." autocomplete="off"/>\n  </div>\n  <button id="sendMessageBtn" class="cems__chatbox__send--footer" onclick=sendMessage()>\n  <img src="https://img.icons8.com/fluency-systems-regular/96/60A5FA/sent.png" onmouseover="this.src='https://img.icons8.com/fluency-systems-filled/96/60A5FA/sent.png'" onmouseout="this.src='https://img.icons8.com/fluency-systems-regular/96/60A5FA/sent.png'"/>\n  </button>\n  \n</div>\n  `);var modal=document.getElementById("cems__myModal"),btn=document.getElementById("cems__myBtn");class InteractiveChatbox{constructor(chatToggleButton,chatbox,icons,chatSection,chatList){this.args={chatToggleButton:chatToggleButton,chatbox:chatbox,chatSection:chatSection,chatList:chatList},this.icons=icons,this.showChatbox=!1,this.isBack=!0,this.inChatList=!0}display(){const{chatToggleButton:chatToggleButton,chatbox:chatbox}=this.args;chatToggleButton.addEventListener("click",()=>this.toggleState(chatbox)),this.chatListOrUserEffect(),this.unreadMessageCountDisplay()}chatListOrUserEffect(){let chatDiv=document.querySelector(".chatlist__footer__chatIcon"),userDiv=document.querySelector(".chatlist__footer__userIcon"),unreadMessageCountP=document.getElementById("unreadMessageCountP"),unreadMessageCountDiv=document.getElementById("unreadMessageCount");this.inChatList?(chatDiv.src="https://img.icons8.com/ios-filled/100/000000/communication.png",userDiv.src="https://img.icons8.com/ios/50/000000/user.png"):(chatDiv.src="https://img.icons8.com/ios/100/000000/communication.png",userDiv.src="https://img.icons8.com/ios-filled/100/000000/user.png")}unreadMessageCountDisplay(){let unreadMessageCountDiv=document.getElementById("unreadMessageCount");0===unreadMessageId.length?unreadMessageCountDiv.style.display="none":(unreadMessageCountDiv.style.display="flex",unreadMessageCountDiv.innerHTML=`<p id="unreadMessageCountP">${unreadMessageId.length}</p>`)}gotoUsers(){this.inChatList=!1,this.chatListOrUserEffect()}toggleState(chatbox){this.showChatbox=!this.showChatbox,this.showOrHideChatBox(chatbox,this.args.chatToggleButton)}chatInitWithUid(chatbox){this.showChatbox||(chatbox.classList.remove("cems__chatbox--active"),this.toggleIcon(!1,this.args.chatToggleButton)),this.showChatbox=!0,this.showOrHideChatBox(chatbox,this.args.chatToggleButton)}chatboxoff(){this.showChatbox=!1,this.toggleIcon(!1,this.args.chatToggleButton),this.args.chatbox.classList.remove("cems__chatbox--active")}showOrHideChatBox(chatbox,chatToggleButton){this.showChatbox?(chatbox.classList.add("cems__chatbox--active"),this.toggleIcon(!0,chatToggleButton)):this.showChatbox||(chatbox.classList.remove("cems__chatbox--active"),this.toggleIcon(!1,chatToggleButton))}toggleIcon(showChatbox,chatToggleButton){const{isClicked:isClicked,isNotClicked:isNotClicked}=this.icons;showChatbox?chatToggleButton.children[0].innerHTML=isClicked:showChatbox||(chatToggleButton.children[0].innerHTML=isNotClicked)}gotoChat(){const{chatSection:chatSection,chatList:chatList}=this.args;if(this.isBack=!this.isBack,!this.isBack){chatSection.classList.remove("cems__hide__section"),chatList.classList.add("cems__hide__section");var chatEl=document.getElementById("cems__chatbox__messages");chatEl.scrollTop=chatEl.scrollHeight}}backTochatList(){this.inChatList=!0,this.chatListOrUserEffect(),this.unreadMessageCountDisplay();const{chatSection:chatSection,chatList:chatList}=this.args;this.isBack=!this.isBack,this.isBack&&(chatList.classList.remove("cems__hide__section"),chatSection.classList.add("cems__hide__section"))}}const chatToggleButton=document.querySelector(".cems__chatbox__button"),chatContent=document.querySelector(".cems__chatbox__support"),chatList=document.getElementById("cems__chatbox__chatlists"),chatSection=document.getElementById("cems__chatbox__chatting"),icons={isClicked:'<img class="arrowIcon" src="https://img.icons8.com/ios-glyphs/90/ffffff/expand-arrow--v1.png"/>',isNotClicked:'<img class="chatIcon" src="https://img.icons8.com/external-kiranshastry-lineal-kiranshastry/64/ffffff/external-chat-multimedia-kiranshastry-lineal-kiranshastry.png"/>'},chatbox=new InteractiveChatbox(chatToggleButton,chatContent,icons,chatSection,chatList);chatbox.display(),chatbox.toggleIcon(!1,chatToggleButton);let getAuthToken=async(email,pass)=>{try{const response=await axios.post(`https://tradazine.com/api/v1/login?username=${email}&password=${pass}`);let res={token:response.data.access_token,uid:response.data.chat_uid,name:response.data.name};return allDetails.access_token=response.data.access_token,await res}catch(error){return res={token:null,uid:email,name:email}}},bsChatInit=async(email,pass,appId,tokenUrl,appCertificate,rington,callerTune)=>{backToChatList();let authData=await getAuthToken(email,pass);await agoraFunction.init(authData.uid,authData.name,appId,authData.token,rington,callerTune,tokenUrl,appCertificate)},chatInitWithUid=id=>{const chatContent=document.querySelector(".cems__chatbox__support");chatbox.chatInitWithUid(chatContent),inMessages=!0,showMesseges(id.toString())},logoutFromAgora=()=>{chatbox.chatboxoff(),agoraFunction.logout()};